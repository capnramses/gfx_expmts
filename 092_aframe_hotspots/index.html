<html>
<!-- NOTE(Anton) A-Frame works on the Oculus Rift which suggests good handling of WebXR/WebVR fallback by A-Frame -->

<head>
	<meta charset="UTF-8">
	<script src="https://aframe.io/releases/1.0.4/aframe.min.js"></script>
</head>

<body onload="load_hotspots()">
	<a-scene>
		<!-- NOTE(Anton) assets are loaded before displaying the scene. loading inline with eg <a-entity gltf-model="url(/path/to/tree.gltf)"></a-entity> won't wait -->
		<a-assets>
			<a-asset-item id="sponza" src="../common/meshes/Sponza/glTF/Sponza.gltf"></a-asset-item>
			<a-asset-item id="infopoint" src="infopoint.glb"></a-asset-item>
		</a-assets>

		<a-entity gltf-model="#sponza"></a-entity>
		<a-entity gltf-model="#infopoint" scale="0.5 0.5 0.5" position="0 2 0"></a-entity>
		<!--
			<a-entity obj-model="obj: url(infopoint.obj); mtl: url(infopoint.mtl)" scale="0.5 0.5 0.5" position="0 2 0">		
		</a-entity>
-->

		<!-- note: onload doesnt work here -->
		<a-entity geometry="primitive: plane; width: 4; height: auto" material="color: green; opacity:0.66;
			transparent:true" text="value: This text will be 4 units wide." position=" 2 2 -1 " rotation="0 90 0" id="my_text">
		</a-entity>


	</a-scene>
</body>

</html>

<script>
	// NOTE(Anton) needed to specify .mtl before .obj was visible in scene
	// NOTE(Anton) when my .obj was quads A-Frame incorrectly triangulated it so it was inside-out. had to pre-triangulate
	// NOTE(Anton) needed newest Blender for reliable GLB export
	// NOTE(Anton) GLTF looks matte, OBJ looks shiny - this could be a PBR/Phong difference
	// NOTE(Anton) read this about setting up JS for a-frame: https://aframe.io/docs/1.0.0/introduction/javascript-events-dom-apis.html



	// TODO(Anton) function to get cam pos and distance from markers and transition to content

	//  onload="antons_popup()"
	function antons_popup() {
		alert(" This is a test pop-up from Anton to make sure JavaScript stuff is integrating okay");
	}
	var text = "not loaded yet";

	function load_hotspots() {

		var ajaxRequest = new XMLHttpRequest();
		ajaxRequest.onreadystatechange = function () {
			if (ajaxRequest.readyState == 4) {
				console.log("Ready state changed!");
				var jsonObj = JSON.parse(ajaxRequest.responseText);
				alert(jsonObj.hotspots[0].text);
				text = jsonObj.hotspots[0].text;


				//document.getElementById('my_text').text = "value:" + text;
				console.log("asasmy text value is:" + document.getElementById('my_text').text);

			}
		}
		ajaxRequest.open("GET", "test.json", true);
		ajaxRequest.send();
	}

	//document.getElementById('my_text').text = "value:" + text;
	console.log("my text value is:" + document.getElementById('my_text').text);

</script>